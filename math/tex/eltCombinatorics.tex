\M
Probability amounts to calculate
\begin{equation}
\Pr(A)=\frac{\begin{pmatrix}\mbox{number of}\\
\mbox{elements in $A$}
  \end{pmatrix}}{|\sampleSpace|}.
\end{equation}
This is both a blessing and a curse: for we change probability into
counting, yet counting can be difficult! We will review elements of
combinatorics (``the art of counting'').

\subsection{Permutations}
\M
Suppose we want to consider how many ways we can order $n$
elements. What to do?

We first say ``We have $n$ slots to fill with our $n$ elements.'' Then
we pick some element, and note how many possible slots we may choose. We
may pick any one of our $n$ slots. Then pick our second element, and we
may place it in any of the remaining $(n-1)$ slots. We continue, and
there are 
\begin{equation}
n(n-1)(n-2)(\cdots)(1)=n!
\end{equation}
different methods of ordering our $n$ elements. Thus there are $n!$
different permutations.

\N*{Convention:} We set $0!=1$.

\M
Factorial grows quite rapidly. For example
\begin{subequations}
\begin{align}
3!&=6\\
6!&=720\\
12!&=479\,001\,600
\end{align}
\end{subequations}
We may approximate it using \define{Stirling's Approximation}
\begin{equation}
n!\sim\sqrt{2\pi n}\left(\frac{n}{\E}\right)^{n}.
\end{equation}
We may derive this from the Gamma function\index{Gamma function}\index{$\Gamma(x)$}
\begin{equation}
\Gamma(x)=\int^{\infty}_{0}t^{x-1}\E^{-t}\,\D t,\qquad\mbox{for
}\Re(x)>0.
\end{equation}
We take $\Gamma(n+1)$ and integrate by parts $n$ times, we find
\begin{equation}
\Gamma(n+1)=n!
\end{equation}
for $n\in\NN$.

Integrating $\Gamma(x+1)$ by parts merely once will give us the
functional equation
\begin{equation}
\Gamma(x+1)=x\Gamma(x).
\end{equation}
Calculus students around the world prove everyday that
\begin{equation}
\Gamma(1/2)=\sqrt{\pi}
\end{equation}
without ever realizing it!

\subsection{Sampling}
\M
Given some collection of elements (or a ``population''), we would like
to pick a finite number of elements (a ``sample''). A population with
$n$ elements $\{a_{1},\dots,a_{n}\}$, any \emph{ordered} arrangement of
$r$ symbols $a_{j_{1}}$, \dots, $a_{j_r}$ is an \define{Ordered Sample
  of Size $r$} drawn from the population. Note when $r=n$, an ordered
sample is just a permutation of the population.

\N*{Sampling with Replacement:}
The elements are drawn from the entire population, so we may pick the
same element twice (or more).

\N*{Sampling Without Replacement:}
Once we choose an element, we cannot pick it again. We reduce the
possible choices, and hence more limited than sampling with replacement.

\medbreak
Choosing $r$ elements with replacement from a population of $n$ can be
done in $n^{r}$ different ways. The proof is obvious: you have $r$
choices, and each choice has $n$ possibilities. So there are 
\begin{equation}
\underbrace{n\cdot(\cdots)\cdot n}_{\text{$r$ times}} = n^{r}
\end{equation}
different ways to sample.

How many different ways can we sample $r$ elements without replacement
from a population with $n$ elements? 

\M
Since ordering matters, we have
\begin{equation}
n(n-1)(\cdots)\bigl(n-(r-1)\bigr)=(n)_{r}
\end{equation}
This defines the \define{Falling Factorial} $(n)_{r}$.

How can we be certain about this? Well, for the first choice there are
$n$ possibilities. The second has $(n-1)$ possibilities. The $k^{th}$
has $(n-(k-1))$ possible choices. We then multiply these together to get
the result.

\N{Theorem}
For a population with $n>1$ elements and a prescribed sample size $r\leq n$,
there exists $n^{r}$ different samples with replacement, and $(n)_{r}$
samples without replacement.

\N{Birthday Problem}
How many people do we need in a room to make a favorable bet (i.e., a
bet with probability of success greater than $1/2$) that 2 people in the
room will have the same birthday?

\N*{Solution:}
Let $r$ be the number of people in the room, we want to find it. We will
compute the probability of no repetition in our data (i.e., the
probability no one in the room shares a birthday). The population, for
this example, is the 365 days of the year. 

Then
\begin{equation}
p_{r} = \frac{(365)_{r}}{365^{r}}
\end{equation}
describes the probability that no one shares a birthday. We want to find
the smallest $r$ such that $p_{r}<0.5$. This can be done by exhaustion,
we find
\begin{equation}
\begin{split}
p_{23} &=
\frac{36997978566217959340182499134166757044383351847256064}{75091883268515350125426207425223147563269805908203125}\\
&\approx 0.49270276
\end{split}
\end{equation}
So only make this bet when there are at least 23 people in the room!

%%%%%%%%%%
\subsection{Binomial Coefficients}
\M
How many samples of size $r$ exist in a population of $n$ elements,
without regard to ordering? That is, how many ways can we choose $r$
guys from $n$ elements? We count this using binomial coefficients
\begin{equation}
\binom{n}{r} = \frac{n!}{r!(n-r)!}
\end{equation}
and read it as ``$n$ choose $r$''. Why is this true? Great question: we
have $(n)_r$ subpopulations, and $r!$ different orderings of each
subpopulation, so we have
\begin{equation}
\binom{n}{r}=\frac{(n)_{r}}{r!}.
\end{equation}
But this is precisely what we have written!

\N*{Convention}
If $k\geq n$, then
\begin{equation}
\binom{n}{k}=0.
\end{equation}

\N{Theorem}
A population with $n$ elements has $\binom{n}{r}$ different
subpopulations of size $r\leq n$.

\N{Theorem (Properties of the Binomial Coefficients)}\label{thm:propertiesOfBinomialCoefficients}
Let $0\leq k\leq n$. Then
\begin{enumerate}
\item $\displaystyle\binom{n}{0}=\binom{n}{n}=1$
\item\label{thm:binom:prop:symmetry} $\displaystyle\binom{n}{k}=\binom{n}{n-k}$
\item Pascal's triangle $\displaystyle\binom{n}{k}+\binom{n}{k+1}=\binom{n+1}{k+1}$
\end{enumerate}

\begin{proof}
(1) We see by definition that
\begin{subequations}
\begin{equation}
\binom{n}{0}=\frac{n!}{(n-0)!0!}=\frac{n!}{n!}=1,
\end{equation}
and similarly
\begin{equation}
\binom{n}{n}=\frac{n!}{(n-n)!n!}=\frac{n!}{n!}=1.
\end{equation}
\end{subequations}
That proves (1).

(2) We see that
\begin{subequations}
\begin{equation}
\binom{n}{k}=\frac{n!}{(n-k)!k!}
\end{equation}
and
\begin{equation}
\binom{n}{n-k}=\frac{n!}{\bigl(n-(n-k)\bigr)!(n-k)!}=\frac{n!}{k!(n-k)!}
\end{equation}
\end{subequations}
Then setting equals to equals proves (2).

(3) We recall the generating function for binomial coefficients is given by
\begin{subequations}
\begin{equation}
(1+x)^{n}=\sum^{n}_{k=0}\binom{n}{k}x^{k},
\end{equation}
so
\begin{equation}\label{eq:pf:pascalTriangle:eq1}
(1+x)^{n+1}=\sum^{n+1}_{k=0}\binom{n+1}{k}x^{k}.
\end{equation}
But simple arithmetic also suggests
\begin{equation}
\begin{split}
(1+x)^{n}(1+x)&=1\cdot\sum^{n}_{k=0}\binom{n}{k}x^{k}+x\sum^{n}_{k=0}\binom{n}{k}x^{k}\\
&=\sum^{n}_{k=0}\binom{n}{k}x^{k}+\sum^{n}_{k=0}\binom{n}{k}x^{k+1}.
\end{split}
\end{equation}
We can rewrite this as
\begin{equation}\label{eq:pf:pascalTriangle:eq2}
\begin{split}
(1+x)^{n}(1+x)&=1+\sum^{n}_{k=1}\binom{n}{k}x^{k}+\sum^{n}_{k=1}\binom{n}{k-1}x^{k}+x^{n+1}\\
&=1+\sum^{n}_{k=1}\left[\binom{n}{k}+\binom{n}{k-1}\right]x^{k}+x^{n+1}
\end{split}
\end{equation}
and thus we conclude, setting Eq \eqref{eq:pf:pascalTriangle:eq1} equal
to Eq \eqref{eq:pf:pascalTriangle:eq2}, the coefficients of powers of
$x$ must be equal. Thus
\begin{equation}
\binom{n+1}{k}=\binom{n}{k}+\binom{n}{k-1},
\end{equation}
\end{subequations}
which implies (3).
\end{proof}

\begin{cor}
Let $n,k\in\NN$, then
\begin{equation}
\binom{n}{-k}=0.
\end{equation}
\end{cor}
\begin{proof}[Proof of Corollary]
By statement \ref{thm:binom:prop:symmetry} of the previous theorem, we
have
\begin{equation}
\binom{n}{-k}=\binom{n}{n+k}
\end{equation}
Since $k>0$, our convention implies that
\begin{equation}
\binom{n}{n+k}=0
\end{equation}
as desired.
\end{proof}

\begin{xca}
Prove $\binom{n}{0}+\binom{n}{1}+\dots+\binom{n}{n}=2^{n}$.
\end{xca}

\N{Example}
A deck of cards has 52 cards, a poker hand has 5 cards.
How many different poker hands are there?

\N*{Solution:}
We see there are
\begin{equation}
\binom{52}{5}=2\,598\,960
\end{equation}
different poker hands.

\N{Example}
The US Senate has 100 Senators (a pair represents each state). If a
committee is formed with 50 senators, then:

(a) What's the probability a given state is represented?

(b) What's the probability each state is represented?

\N*{Solution}
(a) Well, we first consider the \emph{negation} of this statement: what's
the probability not every state is represented? There are
\begin{equation}
\binom{98}{50} = d_{k}
\end{equation}
ways to choose the committee so some state is not represented. But there
is 
\begin{equation}
\binom{100}{50}=n_{k}
\end{equation}
different ways to choose the committee. Thus the probability a given state is
not represented is
\begin{equation}
q = \frac{\displaystyle\binom{98}{50}}{\displaystyle\binom{100}{50}} = \frac{49}{198}\approx 0.24747\dots
\end{equation}
and hence the probability a given state is represented is
\begin{equation}
1-q = \frac{149}{198} \approx 0.7525\dots
\end{equation}
That concludes the first question.

(b)
We pick one senator from each state. We have two possibilities for each
state, and 50 states, hence we have $2^{50}$ possibilities. Thus we have
\begin{equation}
p = \frac{2^{50}}{\displaystyle\binom{100}{50}} \approx 1.11\times10^{-14}
\end{equation}
is the probability every state is represented.

\subsubsection{Binomial Distribution}
\N{Example}
Consider a random distribution of $r$ balls in $n$ urns. Find the
probability $p_{k}$ that a specified cell contains exactly $k$ balls.

\N*{Solution:}
We want to find
\begin{equation}
p_{k} = \frac{\begin{pmatrix}
    \mbox{Number of ways to}\\
    \mbox{choose $k$ balls from}\\
    \mbox{$r$ balls}
  \end{pmatrix}
\begin{pmatrix}
  \mbox{number of ways to}\\
  \mbox{put remaining $(r-k)$ balls}\\
  \mbox{in $(n-1)$ cells}
\end{pmatrix}}{\begin{pmatrix}\mbox{number of different}\\
\mbox{ways placing $r$}\\
\mbox{balls in $n$ cells}
  \end{pmatrix}}
\end{equation}
There are $n^{r}$ different ways placing $r$ balls in $n$ cells. This
gives us the denominator. We see that
\begin{equation}
\begin{pmatrix}
    \mbox{Number of ways to}\\
    \mbox{choose $k$ balls from}\\
    \mbox{$r$ balls}
  \end{pmatrix} = \binom{r}{k}
\end{equation}
and what of the remaining $(r-k)$ balls? They can be placed in the
remaining cells in $(n-1)^{r-k}$ ways. Thus we plug this all back into
our equation to find
\begin{equation}
\begin{split}
p_{k}&=\frac{\displaystyle\binom{r}{k}(n-1)^{r-k}}{n^{r}}\\
&=\binom{r}{k}\frac{1}{n^{k}}\left(1-\frac{1}{n}\right)^{r-k}.
\end{split}
\end{equation}
This is an example of the famous \emph{binomial distribution}\marginpar{Binomial Distribution}\index{Binomial Distribution}, which
we'll soon study.

\M
Suppose we toss a fair coin $n$ times. What's the probability we have
$k$ heads? 

\N*{Solution:}
The basic solution we will propose will look like
\begin{equation}
\Pr(\mbox{$k$ heads})=\begin{pmatrix}\mbox{number of}\\
\mbox{combinations}
\end{pmatrix}
\begin{pmatrix}
\mbox{probability of}\\
\mbox{one heads}
\end{pmatrix}^{k}
\begin{pmatrix}
\mbox{probability of}\\
\mbox{one tails}
\end{pmatrix}^{n-k}
\end{equation}
We have a subpopulation of $k$ heads in a population with $n$
elements. So
\begin{equation}
\begin{pmatrix}\mbox{number of}\\
\mbox{combinations}
\end{pmatrix}=\binom{n}{k}
\end{equation}
and
\begin{equation}
\begin{pmatrix}
\mbox{probability of}\\
\mbox{one heads}
\end{pmatrix}=
\begin{pmatrix}
\mbox{probability of}\\
\mbox{one tails}
\end{pmatrix}=\frac{1}{2}.
\end{equation}
More generally, we will write
\begin{equation}
p=\begin{pmatrix}
\mbox{probability of}\\
\mbox{one heads}
\end{pmatrix},\quad\mbox{and}\quad (1-p)=\begin{pmatrix}
\mbox{probability of}\\
\mbox{one tails}
\end{pmatrix}.
\end{equation}
So we conclude
\begin{equation}
\Pr(\mbox{$k$ heads})=\binom{n}{k}p^{k}(1-p)^{n-k}.
\end{equation}

\N*{Solution 2:}
Let $p$ be the probability of success (heads), and $q$ the probability
of failure (tails), for one trial. Then we consider the Binomial
expansion of 
\begin{equation}
(p+q)^{n}=p^{n}+\dots+\binom{n}{k}p^{k}q^{n-k}+\dots+q^{n}.
\end{equation}
Each term represents one outcome, namely, the coefficient of $p^{k}$ is
the outcome with $k$ successes. So
\begin{equation}
\Pr(\mbox{$k$ heads})=\binom{n}{k}p^{k}q^{n-k}.
\end{equation}
Since the only outcomes are success or failure, we have
\begin{equation}
p+q=1,
\end{equation}
which implies $q=1-p$ and ``something must happen''. Thus we conclude
\begin{equation}
\Pr(\mbox{$k$ heads})=\binom{n}{k}p^{k}(1-p)^{n-k}
\end{equation}
recovering our previous solution.

%%%%%%%%%%
\subsection{Multinomial Coefficient}
\M
Suppose we have a population with $n$ elements. How many different ways
can we partition the population into subpopulations with $k_1$
members, \dots, $k_m$ members?

\begin{xca}
Prove that $k_1+\dots+k_m=n$.
\end{xca}

We have the following number of such partitions:
\begin{equation}
\binom{n}{k_1,\dots,k_m} = (k_1,\dots,k_m)! = \frac{(k_1+\dots+k_m)!}{k_1!(\dots)k_m!}
\end{equation}
These quantities are called \define{Multinomial Coefficients}.
The notation varies according to the text. 

%%%%%%%%%%
\subsection{Hat Check Problem}\label{subsec:hatCheckProblem}
\N{Problem Statement}
At a restaurant, $n$ people check their hats.
The hat checker completely loses track of who owns which hat, and begins
handing the hats randomly to the owners. What's the probability no one
receives their hat back?

\M
We really want to consider the permutations
\begin{equation}
\sigma = \begin{pmatrix} 1 & 2 & 3 & \dots & n\\
a_1 & a_2 & a_3 & \dots & a_N
\end{pmatrix}
\end{equation}
such that there are \emph{no fixed points} (i.e., $a_{k}\neq k$ for
every $k$).

\N{Solution}
Let $A_{i}$ be the event the $i^{th}$ element is fixed. Then 
\begin{equation}
A_1\cup A_2\cup\dots A_n = \begin{pmatrix}\mbox{event there exists}\\
\mbox{at least one}\\
\mbox{fixed point}
\end{pmatrix}
\end{equation}
then
\begin{equation}
\Pr(\mbox{no fixed pt}) = 1-\Pr(A_1\cup A_2\cup\dots A_n).
\end{equation}
We just have to compute $\Pr(A_1\cup A_2\cup\dots A_n)$. What to do? Use
inclusion-exclusion!

\M So we consider the event $A_{i}$. The permutation would look like
\begin{equation}
\begin{pmatrix}
1 & 2 & 3 & \dots & i & \dots & n\\
  &   &   & \dots & i & \dots &  \\
\end{pmatrix}
\end{equation}
where the blank entries are arbitrary (we don't care where they go). How
many different such permutations are there? Well, it's as though we
permute the $(n-1)$ elements other than $i$, so there are $(n-1)!$ such
permutations. The probability of this event is then
\begin{equation}
\Pr(A_{i}) = \frac{(n-1)!}{n!} = \frac{1}{n}.
\end{equation}
There are $n$ such events (since we can let $i=1,\dots,n$). Thus
\begin{equation}
\sum^{n}_{i=1}\Pr(A_{i}) = n\cdot\frac{1}{n}=1.
\end{equation}
Wonderful.

\M Consider the event $A_i\cap A_j$, which has the permutation
\begin{equation}
\begin{pmatrix}
1 & 2 & \dots & i & \dots & j & \dots & n\\
  &   & \dots & i & \dots & j & \dots &  \\
\end{pmatrix}
\end{equation}
How many such permutations are there? Well, we fix two points while
permuting the others, so there are $(n-2)!$ such permutations. Thus the
probability is
\begin{equation}
\Pr(A_{i}\cap A_{j}) = \frac{(n-2)!}{n!}=\frac{1}{n(n-1)}
\end{equation}
How many such ``fix two point'' events are there? It's simply
\begin{equation}
\binom{n}{2}=\frac{n(n-1)}{2}
\end{equation}
thus
\begin{equation}
\sum_{1\leq i<j\leq n} \Pr(A_{i}\cap A_{j})
= \frac{n(n-1)}{2}\cdot\frac{1}{n(n-1)}=\frac{1}{2}.
\end{equation}
This will be our second term.

\M Consider the event $A_i\cap A_j\cap A_k$. We see
\begin{equation}
\Pr(A_i\cap A_j\cap A_k) = \frac{(n-3)!}{n!}=\frac{1}{n(n-1)(n-2)}.
\end{equation}
There are $\binom{n}{3}$ such terms. Thus
\begin{equation}
\sum_{1\leq i<j<k\leq n}\Pr(A_i\cap A_j\cap A_k)=\frac{1}{3!}
\end{equation}
and inductively we find
\begin{equation}
\Pr(A_1\cap\dots\cap A_n)=\frac{1}{n!}
\end{equation}
Thus
\begin{equation}
\Pr(\mbox{no fixed pt}) = \frac{1}{2}
- \frac{1}{3!}+\frac{1}{4!}+\dots+\frac{(-1)^{n}}{n!}
\end{equation}
We should note the Taylor series for $\E^{x}$ is
\begin{equation}
\E^{x}=1+x+\frac{x^{2}}{2!}+\dots+\frac{x^{n}}{n!}+\dots
\end{equation}
so
\begin{equation}
\E^{-1}=1-1+\frac{(-1)^{2}}{2!}+\dots+\frac{(-1)^{n}}{n!}+\dots
\end{equation}
implies
\begin{equation}
\Pr(\mbox{no fixed pt})\to\E^{-1}
\end{equation}
as $n\to\infty$.

We will construct a table, let $p_{n}$ be the probability there are no
fixed points among permutations of $n$ elements. Then:
\begin{equation}
\begin{split}
p_2 &= \frac{1}{2} \approx 0.5\\
p_3 &= \frac{1}{3} \approx 0.33333334\\
p_4 &= \frac{3}{8} \approx 0.375\\
p_5 &= \frac{11}{30} \approx 0.36666667\\
p_6 &= \frac{53}{144} \approx 0.36805555\\ 
p_7 &= \frac{103}{280} \approx 0.36785713\\ 
p_8 &= \frac{2119}{5760} \approx 0.36788195\\ 
p_9 &= \frac{16687}{45360} \approx 0.36787918
\end{split}
\end{equation}
We should note that $1/\E\approx 0.36787944117144233$, so we are getting
a decent approximation with $n=8$ (five digits!).
